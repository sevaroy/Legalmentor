#!/bin/bash

# æµ‹è¯•è¿è¡Œè„šæœ¬
# ç”¨æ³•: ./tools/run-tests.sh [unit|integration|e2e|all]

set -e

TEST_TYPE=${1:-all}

echo "ğŸ§ª è¿è¡Œæµ‹è¯•: $TEST_TYPE"

case $TEST_TYPE in
  "unit")
    echo "è¿è¡Œå•å…ƒæµ‹è¯•..."
    if [ -f "tests/unit/test_fastapi.py" ]; then
      python tests/unit/test_fastapi.py
    fi
    ;;
  "integration")
    echo "è¿è¡Œé›†æˆæµ‹è¯•..."
    if [ -f "tests/integration/test_ragflow_connection.py" ]; then
      python tests/integration/test_ragflow_connection.py
    fi
    if [ -f "tests/integration/test-knowledge-api.js" ]; then
      node tests/integration/test-knowledge-api.js
    fi
    ;;
  "e2e")
    echo "è¿è¡Œç«¯åˆ°ç«¯æµ‹è¯•..."
    if [ -f "tests/e2e/quick-strategy-test.js" ]; then
      node tests/e2e/quick-strategy-test.js
    fi
    if [ -f "tests/e2e/test-all-features.js" ]; then
      node tests/e2e/test-all-features.js
    fi
    ;;
  "all")
    echo "è¿è¡Œæ‰€æœ‰æµ‹è¯•..."
    $0 unit
    $0 integration
    $0 e2e
    ;;
  *)
    echo "ç”¨æ³•: $0 [unit|integration|e2e|all]"
    exit 1
    ;;
esac

echo "âœ… æµ‹è¯•å®Œæˆ!"